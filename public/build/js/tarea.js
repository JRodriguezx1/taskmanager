!function(){console.log("xx"),async function(){try{const t=new URLSearchParams(window.location.search);let a=Object.fromEntries(t.entries());const n="/api/tareas?id="+a.id,r=await fetch(n),c=await r.json();e=c,o()}catch(e){console.log(e)}}();let e=[],t=[];document.querySelector("#agregar-tarea").addEventListener("click",(function(){n(!1)}));function a(a){const n=a.target.value;""!=n?(t=e.filter(e=>e.estado===n),"0"==n&&0==t.length&&(t[0]="0"),"1"==n&&0==t.length&&(t[0]="1")):t=["2"],o()}function o(){let a=t.length?t:e;if("0"==t[0]&&(a=[]),"1"==t[0]&&(a=[]),"2"==t[0]&&(a=e),function(){const e=document.querySelector("#listado-tareas");for(;e.firstChild;)e.removeChild(e.firstChild)}(),0==a.length){const e=document.querySelector("#listado-tareas"),a=document.createElement("LI");a.textContent="No hay tareas","0"==t[0]&&(a.textContent="No hay tareas pendientes"),"1"==t[0]&&(a.textContent="No hay tareas completadas"),a.classList.add("no-tareas"),e.appendChild(a)}else{const t={0:"Pendiente",1:"Completa"},c=document.querySelector("#listado-tareas");a.forEach(a=>{console.log(a);const i=document.createElement("LI");i.dataset.tareaid=a.id,i.classList.add("tarea");const s=document.createElement("P");s.textContent=a.nombre,s.ondblclick=function(){n(!0,{...a})};const d=document.createElement("DIV");d.classList.add("opciones");const l=document.createElement("BUTTON");l.classList.add("estado-tarea"),l.classList.add(""+t[a.estado].toLowerCase()),l.textContent=t[a.estado],l.dataset.estadotarea=a.estado,l.ondblclick=function(){!async function(t){const a="1"===t.estado?"0":"1";t.estado=a;const n=new URLSearchParams(window.location.search);const c=Object.fromEntries(n.entries()).id,{id:i,nombre:s,estado:d,idproyectos:l}=t,m=new FormData;m.append("id",i),m.append("nombre",s),m.append("estado",d),m.append("idproyectos",l),m.append("url",c);try{const t=await fetch("http://uptask_mvc.test/api/tarea/actualizar",{method:"POST",body:m});"exito"==(await t.json()).tipo&&r("Actualizado correctamente","exito",document.querySelector(".contenedor-nueva-tarea")),e=e.map(e=>(e.id===i&&(e.estado=d),e)),o()}catch(e){console.log(e)}}({...a})};const m=document.createElement("BUTTON");m.classList.add("eliminar-tarea"),m.dataset.idtarea=a.id,m.textContent="Eliminar",m.ondblclick=function(){!function(t){Swal.fire({title:"Eliminar tarea?",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"no"}).then(a=>{a.isConfirmed&&async function(t){const a=new URLSearchParams(window.location.search);const n=Object.fromEntries(a.entries()).id,{id:r,nombre:c,estado:i,idproyectos:s}=t,d=new FormData;d.append("id",r),d.append("nombre",c),d.append("estado",i),d.append("idproyectos",s),d.append("url",n);try{const a=await fetch("http://uptask_mvc.test/api/tarea/eliminar",{method:"POST",body:d}),n=await a.json();console.log(n),1==n.resultado&&(Swal.fire("Eliminado","Tarea Eliminada correctamente","success"),e=e.filter(e=>e.id!=t.id),o())}catch(e){console.log(e)}}(t)})}({...a})},d.appendChild(l),d.appendChild(m),i.appendChild(s),i.appendChild(d),c.appendChild(i)})}}function n(t=!1,a={}){const n=document.createElement("DIV");n.classList.add("modal"),n.innerHTML=`\n        <form class="formulario nueva-tarea" >\n\n        <legend>${t?"Editar nombre de la tarea":"Añade una nueva tarea"}</legend>\n        <div class="campo">\n            <label for="tarea">Tarea</label>\n            <input id="tarea" type="text" name="tarea" placeholder="${a.nombre?"":"Añadir tarea al proyecto actual"}" value="${a.nombre?a.nombre:""}">\n        </div>\n\n        <div class="opciones">\n        <input class="submit-nueva-tarea" type="submit" value="${a.nombre?"Guardar cambios":"Crear tarea"}"/>\n        <button type="button" class="cerrar-modal">Cancelar</button>\n        </div>\n\n        </form>\n        `,setTimeout(()=>{document.querySelector(".formulario").classList.add("animar")},0),document.querySelector(".dashboard").appendChild(n),n.addEventListener("click",(function(c){if(c.preventDefault(),c.target.classList.contains("cerrar-modal")){document.querySelector(".formulario").classList.add("cerrar"),setTimeout(()=>{n.remove()},700)}if(c.target.classList.contains("submit-nueva-tarea")){const n=document.querySelector("#tarea").value.trim();if(""==n)return void r("El nombre de la tarea es obligatorio","error",document.querySelector(".formulario legend"));t?(a.nombre=n,async function(t){const a=new URLSearchParams(window.location.search);const n=Object.fromEntries(a.entries()).id,{id:c,nombre:i,estado:s,idproyectos:d}=t,l=new FormData;l.append("id",c),l.append("nombre",i),l.append("estado",s),l.append("idproyectos",d),l.append("url",n);try{const t=await fetch("http://uptask_mvc.test/api/tarea/actualizar",{method:"POST",body:l});if("exito"==(await t.json()).tipo){const e=document.querySelector(".modal");setTimeout(()=>{e.remove()},3e3),r("cambio de nombre de la tarea correctamente","exito",document.querySelector(".formulario legend"))}e=e.map(e=>(e.id===c&&(e.nombre=i),e)),o()}catch(e){console.log(e)}}(a)):async function(t){const a=new URLSearchParams(window.location.search);const n=Object.fromEntries(a.entries()).id,c=new FormData;c.append("nombre",t),c.append("url",n);try{const a=await fetch("http://uptask_mvc.test/api/tarea",{method:"POST",body:c}),n=await a.json();if(console.log(n),console.log(n.resultado[1]),r(n.mensaje,n.tipo,document.querySelector(".formulario legend")),"exito"==n.tipo){const e=document.querySelector(".modal");setTimeout(()=>{e.remove()},3e3)}const i={id:String(n.resultado[1]),nombre:t,estado:"0",idproyectos:n.idproyectos};e=[...e,i],o()}catch(e){console.log(e)}}(n)}}))}function r(e,t,a){const o=document.querySelector(".alerta");o&&o.remove();const n=document.createElement("DIV");n.classList.add("alerta",t),n.textContent=e,a.parentElement.insertBefore(n,a.nextElementSibling),setTimeout(()=>{n.remove();const e=document.querySelector(".formulario");e&&e.classList.add("cerrar")},2e3)}document.querySelectorAll('#filtros input[type="radio"]').forEach(e=>{e.addEventListener("input",a)})}();